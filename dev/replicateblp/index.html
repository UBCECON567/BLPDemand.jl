<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Introduction · BLPDemand.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">BLPDemand.jl</span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li><a class="tocitem" href="../simulation/">Simulations</a></li><li><a class="tocitem" href="../functions/">Function Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>Introduction</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Introduction</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/UBCECON567/BLPDemand.jl/blob/master/docs/src/replicateblp.md#L" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><hr/><p>title       : &quot;Assignment: reproducing Berry, Levinsohn, &amp; Pakes (1995)&quot; subtitle    :  author      : Paul Schrimpf date        : 2020-02-10 bibliography: &quot;blp.bib&quot; link-citations: true options:       out<em>width : 100%       wrap : true       fig</em>width : 800       dpi : 192 –-</p><p><a href="http://creativecommons.org/licenses/by-sa/4.0/"><img src="https://i.creativecommons.org/l/by-sa/4.0/88x31.png" alt/></a></p><p>This work is licensed under a <a href="http://creativecommons.org/licenses/by-sa/4.0/">Creative Commons Attribution-ShareAlike 4.0 International License</a> </p><h3 id="About-this-document-1"><a class="docs-heading-anchor" href="#About-this-document-1">About this document</a><a class="docs-heading-anchor-permalink" href="#About-this-document-1" title="Permalink"></a></h3><p>This document was created using Weave.jl. The code is available in <a href="https://github.com/ECON567/Dialysis">on github</a>. The same document generates both static webpages and a <a href="dialysis.ipynb">jupyter notebook.</a></p>$<p>\def\indep{\perp!!!\perp} \def\Er{\mathrm{E}} \def\R{\mathbb{R}} \def\En{{\mathbb{E}_n}} \def\Pr{\mathrm{P}} \newcommand{\norm}[1]{\left\Vert {#1} \right\Vert} \newcommand{\abs}[1]{\left\vert {#1} \right\vert} \DeclareMathOperator<em>{\argmax}{arg\,max} \DeclareMathOperator</em>{\argmin}{arg\,min} \def\inprob{\,{\buildrel p \over \rightarrow}\,}  \def\indist{\,{\buildrel d \over \rightarrow}\,}  $</p><h1 id="Introduction-1"><a class="docs-heading-anchor" href="#Introduction-1">Introduction</a><a class="docs-heading-anchor-permalink" href="#Introduction-1" title="Permalink"></a></h1><p>This assigment will attempt to replicate the results of @berry1995.</p><h1 id="Getting-started-1"><a class="docs-heading-anchor" href="#Getting-started-1">Getting started</a><a class="docs-heading-anchor-permalink" href="#Getting-started-1" title="Permalink"></a></h1><p>Load the package for this assignment from github. </p><pre><code class="language-julia">using Pkg
#Pkg.activate(&quot;.&quot;) # If running on  vse.syzygy.ca, you might need to uncomment this command
try
  using BLPDemand
catch
  Pkg.develop(PackageSpec(url=&quot;https://github.com/UBCECON567/BLPDemand.jl&quot;))
  using BLPDemand
end</code></pre><h1 id="Problem-1:-load-and-explore-the-data-1"><a class="docs-heading-anchor" href="#Problem-1:-load-and-explore-the-data-1">Problem 1: load and explore the data</a><a class="docs-heading-anchor-permalink" href="#Problem-1:-load-and-explore-the-data-1" title="Permalink"></a></h1><p>The data from @berry1995 is included in the <code>BLPDemand.jl</code> package.</p><pre><code class="language-julia">df = data_blp1999()

# Optionally, if you like being able to view all your data
if (false)
  using TableView
  if (notusingjupyterorjuno) # this will throw an error. Delete it  or the else branch 
    using Blink
    w = Blink.window()
    body!(w, TableView.showtable(df));
  else 
    TableView.showtable(df);
  end
end</code></pre><p>Create some tables and figures to explore the data. You may want to reproduce table I and/or II from @berry1995.</p><pre><code class="language-julia"># using Plots, DataFramesMeta, StatsPlots # (or whatever)</code></pre><h1 id="Problem-2:-Logit-Demand-1"><a class="docs-heading-anchor" href="#Problem-2:-Logit-Demand-1">Problem 2: Logit Demand</a><a class="docs-heading-anchor-permalink" href="#Problem-2:-Logit-Demand-1" title="Permalink"></a></h1><h2 id="Part-I-1"><a class="docs-heading-anchor" href="#Part-I-1">Part I</a><a class="docs-heading-anchor-permalink" href="#Part-I-1" title="Permalink"></a></h2><p>Reproduce table III of @berry1995. First you&#39;ll need to create instruments as in section 5.1 of the paper. The following code should do it.</p><pre><code class="language-julia">using DataFrames
# Create instruments (see section 5.1)
exog = [:const, :hpwt, :air, :mpd, :space, :mpg, :trend] # not sure that this is correct set of variables
function makeinstruments(df, exog)
  for z ∈ exog
    zown = String(z).*&quot;_own&quot;
    zother = String(z).*&quot;_other&quot;
    own=by(df, [:year, :firm_id], z=&gt;sum)
    rename!(own, Symbol(z, &quot;_sum&quot;) =&gt; Symbol(z, &quot;_own&quot;))
    all=by(df, [:year], z=&gt;sum)
    rename!(all, Symbol(z, &quot;_sum&quot;) =&gt; Symbol(z, &quot;_other&quot;))
    df=join(df, own, on = [:year, :firm_id])
    df=join(df,all, on = [:year])
    df[!,Symbol(z,&quot;_other&quot;)] .-= df[!,Symbol(z,&quot;_own&quot;)]
    df[!,Symbol(z,&quot;_own&quot;)] .-= df[!,z]
  end
  return(df)
end
df=makeinstruments(df, exog);
nothing</code></pre><pre><code class="language-none">nothing</code></pre><p>For the regressions, you should modify the following.</p><pre><code class="language-julia">using FixedEffectModels, RegressionTables
col2 = reg(df, @formula(logit_depvar ~ hpwt + (price ~ const_own + const_other + hpwt_own + hpwt_other)))
regtable(col2)</code></pre><pre><code class="language-none">--------------------------
              logit_depvar
              ------------
                       (1)
--------------------------
(Intercept)      -7.283***
                   (0.166)
hpwt              5.735***
                   (0.761)
price            -0.215***
                   (0.015)
--------------------------
Estimator               IV
--------------------------
N                    2,217
R2                  -0.236
--------------------------</code></pre><h2 id="Part-II-1"><a class="docs-heading-anchor" href="#Part-II-1">Part II</a><a class="docs-heading-anchor-permalink" href="#Part-II-1" title="Permalink"></a></h2><p>Calculate the elasticities of demand implied by the logit model. Report how many own price elasticities have absolute value less than one (inelastic). Why are inelastic demand estimates undesirable?</p><p>For computing the elastiticities, you could adapt the code from the <a href="https://ubcecon567.github.io/BLPDemand.jl/dev/simulation/#Calculating-Elasticities-1">BLPDemand.jl docs</a></p><h1 id="Problem-3:-Demand-Side-Estimation-1"><a class="docs-heading-anchor" href="#Problem-3:-Demand-Side-Estimation-1">Problem 3: Demand Side Estimation</a><a class="docs-heading-anchor-permalink" href="#Problem-3:-Demand-Side-Estimation-1" title="Permalink"></a></h1><p>Estimate a random coefficients demand model. Report the parameter estimates and standard errors. Use the functions <code>estimateRCIVlogit</code> and <code>varianceRCIVlogit</code> from BLPDemand.jl. Note that the paper has price enter the model as <span>$\log(y-p)$</span>, but we lack data on <span>$y$</span>, so just have price enter linearly or log-linearly with a random coefficient.</p><pre><code class="language-julia"># some more data prep. You might want to change
df[!,:loghpwt] = log.(df[!,:hpwt])
df[!,:logmpg] = log.(df[!,:mpg])
df[!,:logspace] = log.(df[!,:space])
S = 20
xvars = [:price, :const, :hpwt, :air, :mpd, :space]
costvars = [:const, :loghpwt, :air, :logmpg, :logspace]
dat = BLPData(df, :year, :firm_id, :share, xvars, costvars,
              [:const], [:const], # we&#39;ll recreate instruments anyway
              randn(length(xvars),S ,length(unique(df[!,:year]))) )
dat = makeivblp(dat, includeexp=false)

using LinearAlgebra: diag, I
# now the estimation, you might want to try different options

#out=estimateRCIVlogit(dat, method=:NFXP, verbose=true, W=I)
#v = varianceRCIVlogit(out.β, out.σ, dat, W=I)
#@show [out.β  out.σ]
#@show sqrt.(diag(v.Σ))

# or make a nicer table as in https://ubcecon567.github.io/BLPDemand.jl/dev/simulation/#Estimation-1</code></pre><h1 id="Problem-4:-Demand-and-Supply-1"><a class="docs-heading-anchor" href="#Problem-4:-Demand-and-Supply-1">Problem 4: Demand and Supply</a><a class="docs-heading-anchor-permalink" href="#Problem-4:-Demand-and-Supply-1" title="Permalink"></a></h1><p>Estimate the full BLP model. Use the <code>estimateBLP</code> and <code>varianceBLP</code> functions. See <a href="https://ubcecon567.github.io/BLPDemand.jl/dev/simulation/#Estimation-1">the docs</a> for example usage. Note that the paper has price enter the model as <span>$\log(y-p)$</span>, but we lack data on <span>$y$</span>, so just have price enter linearly or log-linearly with a random coefficient.</p><h1 id="Problem-5:-Elasticities-1"><a class="docs-heading-anchor" href="#Problem-5:-Elasticities-1">Problem 5: Elasticities</a><a class="docs-heading-anchor-permalink" href="#Problem-5:-Elasticities-1" title="Permalink"></a></h1><p>Compute price elasticities (with standard errors) based on your estimates. You can adapt the code in <a href="https://ubcecon567.github.io/BLPDemand.jl/dev/simulation/#Calculating-Elasticities-1">the docs</a>.</p><h1 id="Problem-6:-Merger-Simulation-1"><a class="docs-heading-anchor" href="#Problem-6:-Merger-Simulation-1">Problem 6: Merger Simulation</a><a class="docs-heading-anchor-permalink" href="#Problem-6:-Merger-Simulation-1" title="Permalink"></a></h1><p>This is a more challenging problem with less guidance. Consider it optional.</p><p>Use your estimates to simulate a merger between firm 11 (Saab, I think) and firm 19 (GM, I think). You can do this by modifying the <code>simulateBLP</code> function. Report the effect of the merger on prices. Be sure to include standard errors.</p></article></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Tuesday 11 February 2020 02:36">Tuesday 11 February 2020</span>. Using Julia version 1.3.0.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
